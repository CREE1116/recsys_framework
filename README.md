# RecSys Framework 2.0

ì´ í”„ë¡œì íŠ¸ëŠ” ì¶”ì²œ ì‹œìŠ¤í…œ ëª¨ë¸ì„ ì‰½ê³  ë¹ ë¥´ê²Œ ì‹¤í—˜, í‰ê°€, ê·¸ë¦¬ê³  í™•ì¥í•˜ê¸° ìœ„í•´ ì„¤ê³„ëœ ê°•ë ¥í•œ ì—°êµ¬ìš© í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤.
**PyTorch**ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•˜ë©°, ìµœì‹  ì¶”ì²œ ëª¨ë¸(Deep Learning, GNN, VAE ë“±)ê³¼ ë‹¤ì–‘í•œ ì†ì‹¤ í•¨ìˆ˜ë¥¼ ëª¨ë“ˆí™”í•˜ì—¬ ì œê³µí•©ë‹ˆë‹¤.

---

## ğŸŒŸ ì£¼ìš” ê¸°ëŠ¥ (Key Features)

- **SOTA ëª¨ë¸ ë¼ì¸ì—…**: MFë¶€í„° LightGCN, Multi-VAE, ê·¸ë¦¬ê³  ìµœì‹  **CSAR (Co-Support Attention RecSys)** ëª¨ë¸êµ°ê¹Œì§€ ë‹¤ì–‘í•œ ë² ì´ìŠ¤ë¼ì¸ ì œê³µ.
- **ëª¨ë“ˆí™”ëœ ì•„í‚¤í…ì²˜**: ë°ì´í„° ë¡œë”, ëª¨ë¸, ì†ì‹¤ í•¨ìˆ˜, í•™ìŠµ ë£¨í”„ê°€ ëŠìŠ¨í•˜ê²Œ ê²°í•©ë˜ì–´ ìˆì–´ í™•ì¥ì´ ìš©ì´í•¨.
- **ê°•ë ¥í•œ ì„¤ì • ì‹œìŠ¤í…œ**: YAML íŒŒì¼ì„ í†µí•´ ëª¨ë¸ êµ¬ì¡°, í•™ìŠµ ì „ëµ, í‰ê°€ ì§€í‘œ ë“±ì„ ì½”ë“œ ìˆ˜ì • ì—†ì´ ë³€ê²½ ê°€ëŠ¥.
- **ìë™í™”ëœ ì‹¤í—˜ íŒŒì´í”„ë¼ì¸**:
  - `grid_search.py`: í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹ ìë™í™”.
  - `run_all_experiments.py`: ì—¬ëŸ¬ ëª¨ë¸ ë™ì‹œ ì‹¤í—˜ ë° ê²°ê³¼ ìš”ì•½(CSV).
- **ë‹¤ì–‘í•œ í‰ê°€ ì§€í‘œ**: NDCG, HitRate ë¿ë§Œ ì•„ë‹ˆë¼ GiniIndex, Coverage, Entropy ë“± ë‹¤ì–‘ì„± ì§€í‘œ ì§€ì›.

---

## ğŸ†š RecBole ëŒ€ë¹„ ê°•ì  (Why This Framework?)

ì´ í”„ë ˆì„ì›Œí¬ëŠ” ëŒ€ê·œëª¨ ë¼ì´ë¸ŒëŸ¬ë¦¬ì¸ **RecBole**ì˜ ë¬´ê±°ìš´ ì¶”ìƒí™”ë¥¼ ê±·ì–´ë‚´ê³ , **ì—°êµ¬(Research)ì™€ ë””ë²„ê¹…**ì— ìµœì í™”ë˜ì—ˆìŠµë‹ˆë‹¤.

| Feature                 | This Framework                                                                                                                                                    | RecBole                                                                                    |
| :---------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------- | :----------------------------------------------------------------------------------------- |
| **ğŸ” Deep Inspection**  | **Native Parameter Tracking** ì§€ì›. `calc_loss`ì—ì„œ ë”•ì…”ë„ˆë¦¬ë§Œ ë°˜í™˜í•˜ë©´ TensorBoard ë° **PNG ê·¸ë˜í”„**ê°€ ìë™ ìƒì„±ë¨. (Gradient, Weight Scale ë“± ì‹¤ì‹œê°„ í™•ì¸ ê°€ëŠ¥) | ë¡œê¹…ì´ ì œí•œì ì´ë©°, ë‚´ë¶€ íŒŒë¼ë¯¸í„°ë¥¼ ì¶”ì í•˜ë ¤ë©´ ì½”ë“œë¥¼ ê¹Šê²Œ ëœ¯ì–´ê³ ì³ì•¼ í•¨.                   |
| **ğŸ¨ Visualization**    | ì‹¤í—˜ ì¢…ë£Œ ì‹œ **Loss ê³¡ì„ , Metric ë³€í™”, íŒŒë¼ë¯¸í„° ë¶„í¬** ê·¸ë˜í”„ë¥¼ `trained_model` í´ë”ì— ì¦‰ì‹œ ìƒì„±. ë³„ë„ ë„êµ¬ ë¶ˆí•„ìš”.                                               | TensorBoard ì˜ì¡´ì ì´ë©°, ê²°ê³¼ ë¦¬í¬íŒ…ì„ ìœ„í•´ì„  ë³„ë„ì˜ ì‹œê°í™” ìŠ¤í¬ë¦½íŠ¸ ì‘ì„± í•„ìš”.             |
| **ğŸ§© Loss Flexibility** | `calc_loss`ê°€ **Tuple**ì„ ë°˜í™˜í•˜ì—¬, Main Lossì™€ Regularization Termì„ ë¶„ë¦¬í•´ì„œ ì¶”ì  ê°€ëŠ¥. ë³µí•©ì ì¸ Loss ì„¤ê³„ê°€ ë§¤ìš° ì§ê´€ì .                                       | ë‹¨ì¼ scalar loss ë°˜í™˜ì´ ê°•ì œë˜ì–´, ì—¬ëŸ¬ Lossê°€ í•©ì³ì§„ ê²½ìš° ê°ê°ì˜ ê¸°ì—¬ë„ë¥¼ í™•ì¸í•˜ê¸° ì–´ë ¤ì›€. |
| **âš¡ Lightweight**      | `torch`, `numpy` ì™¸ ì˜ì¡´ì„± ìµœì†Œí™”. ì»¤ìŠ¤í…€ ëª¨ë¸ ì¶”ê°€ ì‹œ `BaseModel` ìƒì† í›„ 4ê°œ ë©”ì†Œë“œë§Œ êµ¬í˜„í•˜ë©´ ë.                                                              | ë°©ëŒ€í•œ ì¶”ìƒ í´ë˜ìŠ¤ì™€ ë³µì¡í•œ ìƒì† êµ¬ì¡°ë¡œ ì¸í•´ ì»¤ìŠ¤í…€ ëª¨ë¸ êµ¬í˜„ì˜ ì§„ì… ì¥ë²½ì´ ë†’ìŒ.          |

> **"ì—°êµ¬ìëŠ” í”„ë ˆì„ì›Œí¬ì™€ ì‹¸ìš°ì§€ ë§ê³ , ëª¨ë¸ë§ì— ì§‘ì¤‘í•´ì•¼ í•©ë‹ˆë‹¤."**
> ë³µì¡í•œ Config ìƒì†ì´ë‚˜ ìˆ¨ê²¨ì§„ ë¡œì§ ì—†ì´, íŒŒì´ì¬ ì½”ë“œ ê·¸ëŒ€ë¡œì˜ ì§ê´€ì„±ì„ ìœ ì§€í•©ë‹ˆë‹¤.

---

## ğŸ§© ëª¨ë¸ ë¼ì¸ì—… (Model Zoo)

ì´ í”„ë ˆì„ì›Œí¬ëŠ” `src/models/` í•˜ìœ„ì— ì¹´í…Œê³ ë¦¬ë³„ë¡œ ëª¨ë¸ì„ ê´€ë¦¬í•©ë‹ˆë‹¤. ìƒì„¸ ë‚´ìš©ì€ ë§í¬ëœ ë¬¸ì„œë¥¼ ì°¸ê³ í•˜ì„¸ìš”.

### 1. [CSAR Series (Co-Support Learning)](csar_models_summary.md)

_ì „í†µì ì¸ ë‚´ì (Dot Product)ì„ ë„˜ì–´, **ê³µí†µ ê´€ì‹¬ì‚¬(Co-Support)ì˜ ì´ëŸ‰**ìœ¼ë¡œ ì„ í˜¸ë„ë¥¼ ì„¤ëª…í•˜ëŠ” ëª¨ë¸._

- **CSAR**: ê¸°ë³¸ Co-Support Attention ëª¨ë¸.
- **CSAR_R**: Residual Connectionì„ ì¶”ê°€í•˜ì—¬ ê¸°ë³¸ ì·¨í–¥(MF)ê³¼ ìƒì„¸ ê´€ì‹¬ì‚¬(CSAR)ë¥¼ ê²°í•©.
- **CSAR_Sampled**: Sampled Softmax Lossë¥¼ ì‚¬ìš©í•˜ì—¬ ëŒ€ê·œëª¨ ì•„ì´í…œ ê³µê°„ì„ íš¨ìœ¨ì ìœ¼ë¡œ í•™ìŠµ.
- **CSAR_BPR**: Pairwise Ranking Lossë¡œ ìµœì í™”ëœ ë²„ì „.

### 2. [General Baselines](general_models_summary.md)

_í•™ê³„ì™€ ì‚°ì—…ê³„ì—ì„œ ë„ë¦¬ ì“°ì´ëŠ” í‘œì¤€ ëª¨ë¸ë“¤._

- **Graph**: LightGCN
- **AutoEncoder**: Multi-VAE, EASE (Closed-form, High Performance)
- **Matrix Factorization**: MF, NeuMF, SoftplusMF
- **Prototype/Anchor**: ProtoMF, ACF
- **Traditional**: ItemKNN, MostPopular

---

## ï¿½ ì‹¤í—˜ ì„¤ì • (Configuration)

ëª¨ë“  ì‹¤í—˜ì€ `configs/` ë””ë ‰í† ë¦¬ì˜ YAML íŒŒì¼ë¡œ ì œì–´ë©ë‹ˆë‹¤.

- **`configs/dataset/`**: ë°ì´í„°ì…‹ ê²½ë¡œ ë° í¬ë§· ì„¤ì • (e.g., `ml100k.yaml`)
- **`configs/model/`**: ëª¨ë¸ë³„ í•˜ì´í¼íŒŒë¼ë¯¸í„° ì„¤ì •
  - `csar/`: CSAR ê³„ì—´ ëª¨ë¸ ì„¤ì • (e.g., `csar.yaml`, `csar_r_bpr.yaml`)
  - `general/`: ì¼ë°˜ ë² ì´ìŠ¤ë¼ì¸ ì„¤ì • (e.g., `lightgcn.yaml`, `ease.yaml`)

### ì˜ˆì‹œ: CSAR ëª¨ë¸ ì„¤ì • (`configs/model/csar/csar.yaml`)

```yaml
model:
  name: "CSAR"
  embedding_dim: 64
  num_interests: 4 # ê´€ì‹¬ì‚¬ ê°œìˆ˜
  orth_loss_weight: 0.1

train:
  batch_size: 1024
  loss_type: "pairwise" # or "pointwise"
  lr: 0.001
```

---

## ğŸ›  ìœ í‹¸ë¦¬í‹° ë° ë¶„ì„ ë„êµ¬ (Utility & Analysis)

### 1. ë°ì´í„°ì…‹ ìœ í‹¸ë¦¬í‹° (`util/`)

- **`analyze_dataset.py`**: ë°ì´í„°ì…‹ì˜ ë°€ë„, í¬ì†Œì„±, ë¡±í…Œì¼ ë¶„í¬(Gini, Entropy) ë¶„ì„ ë¦¬í¬íŠ¸ ìƒì„±.
- **`create_subset.py`**: ëŒ€ìš©ëŸ‰ ë°ì´í„°ì…‹ì—ì„œ ê°€ë³ê²Œ ì‹¤í—˜í•  ìˆ˜ ìˆëŠ” ì„œë¸Œì…‹ ìƒì„±.
- **`detect_delimiter.py`**: CSV/TSV íŒŒì¼ êµ¬ë¶„ì ìë™ ê°ì§€.

### 2. ì‹¤í—˜ ê²°ê³¼ ë¶„ì„ (`analysis/`)

ì‹¤í—˜ ê²°ê³¼ë¥¼ ì‹¬ì¸µ ë¶„ì„í•˜ê¸° ìœ„í•œ ìŠ¤í¬ë¦½íŠ¸ê°€ ê¸°ëŠ¥ë³„ë¡œ ë¶„ë¥˜ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

- **`analysis/common/` (ê³µí†µ ë¶„ì„)**
  - `plot_losses.py`: í•™ìŠµ Loss ë³€í™” ê³¡ì„  ì‹œê°í™”.
  - `visualize_embeddings.py`: ê¸°ë³¸ t-SNE ì„ë² ë”© ì‹œê°í™”.
  - `long_tail_model_analysis.py`: ëª¨ë¸ë³„ Long-tail ì•„ì´í…œ ì¶”ì²œ ì„±ëŠ¥ ë¹„êµ.
- **`analysis/csar/` (CSAR ì „ìš© ë¶„ì„)**
  - `visualize_CSAR_embedding.py`: Interest Keyì™€ ì•„ì´í…œ ì„ë² ë”©ì˜ ê´€ê³„ë¥¼ ì‹œê°í™”.
  - `analyze_interests.py`: í•™ìŠµëœ ê´€ì‹¬ì‚¬ ë²¡í„°(Topic)ì˜ ì˜ë¯¸ ë¶„ì„.

---

## ğŸ‘©â€ğŸ’» ê°œë°œì ê°€ì´ë“œ (Advanced & Customization)

ìƒˆë¡œìš´ ëª¨ë¸ì„ ì¶”ê°€í•˜ê±°ë‚˜, í”„ë ˆì„ì›Œí¬ì˜ ë‚´ë¶€ êµ¬ì¡°(`calc_loss` íŠœí”Œ ë°˜í™˜ ê·œì•½ ë“±)ë¥¼ ì´í•´í•˜ê³  ì‹¶ë‹¤ë©´ ì•„ë˜ ê°€ì´ë“œë¥¼ ì°¸ê³ í•˜ì„¸ìš”.

- **[ê°œë°œì ê°€ì´ë“œ (Architecture & Extension)](DEVELOPER_GUIDE.md)**: `BaseModel` ì¸í„°í˜ì´ìŠ¤, `Trainer` ë™ì‘ ì›ë¦¬, ëª¨ë¸ ì¶”ê°€ ë°©ë²• ìƒì„¸.

---

## ï¿½ğŸš€ ì‹œì‘í•˜ê¸° (Quick Start)

### 1. í™˜ê²½ ì„¤ì • (Installation)

```bash
# ê°€ìƒí™˜ê²½ ìƒì„± ë° í™œì„±í™”
uv venv --python 3.12.0
source .venv/bin/activate

# í•„ìˆ˜ íŒ¨í‚¤ì§€ ì„¤ì¹˜
uv pip install -r requirements.txt
```

### 2. ì‹¤í—˜ ì‹¤í–‰ (Usage)

#### ë‹¨ì¼ ëª¨ë¸ í•™ìŠµ

```bash
# EASE ëª¨ë¸, ML-100K ë°ì´í„°ì…‹ ì‹¤í–‰
uv run python main.py --dataset_config configs/dataset/ml100k.yaml --model_config configs/model/general/ease.yaml
```

#### ê·¸ë¦¬ë“œ ì„œì¹˜ (Hyperparameter Tuning)

ì„¤ì • íŒŒì¼ì˜ íŒŒë¼ë¯¸í„°ë¥¼ ë¦¬ìŠ¤íŠ¸(e.g., `[0.001, 0.01]`)ë¡œ ë³€ê²½ í›„ ì‹¤í–‰í•˜ë©´ ìë™ìœ¼ë¡œ ëª¨ë“  ì¡°í•©ì„ íƒìƒ‰í•©ë‹ˆë‹¤.

```bash
uv run python grid_search.py --dataset_config configs/dataset/ml100k.yaml --model_config configs/model/csar/csar_r.yaml
```

#### ì „ì²´ ë²¤ì¹˜ë§ˆí¬ ì‹¤í–‰

`run_all_experiments.py`ì— ë“±ë¡ëœ ëª¨ë“  ëª¨ë¸ì„ ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰í•˜ê³  ê²°ê³¼ë¥¼ CSVë¡œ ë¦¬í¬íŒ…í•©ë‹ˆë‹¤.

```bash
uv run python run_all_experiments.py --dataset_config configs/dataset/ml100k.yaml
```

---

## ğŸ“Š ë””ë ‰í† ë¦¬ êµ¬ì¡° (Structure)

```
.
â”œâ”€â”€ configs/              # ì„¤ì • íŒŒì¼
â”‚   â”œâ”€â”€ dataset/
â”‚   â””â”€â”€ model/
â”‚       â”œâ”€â”€ csar/         # CSAR ëª¨ë¸ ì„¤ì •
â”‚       â””â”€â”€ general/      # ë² ì´ìŠ¤ë¼ì¸ ëª¨ë¸ ì„¤ì •
â”œâ”€â”€ data/                 # ë°ì´í„°ì…‹ ì €ì¥ì†Œ
â”œâ”€â”€ src/                  # ì†ŒìŠ¤ ì½”ë“œ
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ csar/         # CSAR ëª¨ë¸ êµ¬í˜„
â”‚   â”‚   â””â”€â”€ general/      # ë² ì´ìŠ¤ë¼ì¸ êµ¬í˜„
â”‚   â”œâ”€â”€ losses.py         # ë‹¤ì–‘í•œ ì¶”ì²œìš© Loss Function êµ¬í˜„
â”‚   â”œâ”€â”€ data_loader.py    # ë°ì´í„° ì „ì²˜ë¦¬ ë° ë¡œë”©
â”‚   â””â”€â”€ trainer.py        # í•™ìŠµ ë£¨í”„
â”œâ”€â”€ trained_model/        # ì‹¤í—˜ ê²°ê³¼ (ëª¨ë¸, ë¡œê·¸, ë©”íŠ¸ë¦­)
â””â”€â”€ run_all_experiments.py
```
