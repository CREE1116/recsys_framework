# RecSys Framework

μ΄ ν”„λ΅μ νΈλ” μ¶”μ² μ‹μ¤ν… λ¨λΈμ„ μ‰½κ² μ‹¤ν—ν•κ³  ν‰κ°€ν•κΈ° μ„ν•΄ μ„¤κ³„λ μ μ—°ν•κ³  ν™•μ¥ κ°€λ¥ν• ν”„λ μ„μ›ν¬μ…λ‹λ‹¤.

## π μ£Όμ” κΈ°λ¥

- **λ‹¤μ–‘ν• λ¨λΈ μ§€μ›**: MF, LightGCN, CSAR λ“± μ—¬λ¬ μµμ‹  μ¶”μ² λ¨λΈμ„ κΈ°λ³ΈμΌλ΅ μ κ³µν•©λ‹λ‹¤.
- **μ‰¬μ΄ ν™•μ¥μ„±**: μƒλ΅μ΄ λ¨λΈμ΄λ‚ λ°μ΄ν„°μ…‹μ„ μ‰½κ² μ¶”κ°€ν•  μ μλ” λ¨λ“μ‹ κµ¬μ΅°.
- **μ„¤μ • κΈ°λ° μ‹¤ν—**: YAML μ„¤μ • νμΌμ„ ν†µν•΄ λ°μ΄ν„°μ…‹, λ¨λΈ, ν•™μµ νλΌλ―Έν„°λ¥Ό μ‰½κ² λ³€κ²½ν•κ³  κ΄€λ¦¬ν•  μ μμµλ‹λ‹¤.
- **μλ™ν™”λ ν•μ΄νΌνλΌλ―Έν„° νλ‹**: κ·Έλ¦¬λ“ μ„μΉλ¥Ό ν†µν•΄ μµμ μ ν•μ΄νΌνλΌλ―Έν„° μ΅°ν•©μ„ μλ™μΌλ΅ νƒμƒ‰ν•©λ‹λ‹¤.
- **μ‹¤ν— κ΄€λ¦¬ λ° κ²°κ³Ό μ·¨ν•©**: μ—¬λ¬ λ¨λΈκ³Ό λ°μ΄ν„°μ…‹μ— λ€ν• μ‹¤ν—μ„ ν• λ²μ— μ‹¤ν–‰ν•κ³ , κ²°κ³Όλ¥Ό λ‹¨μΌ CSV νμΌλ΅ μ”μ•½ν•μ—¬ λΉ„κµ λ¶„μ„μ„ μ©μ΄ν•κ² ν•©λ‹λ‹¤.

## π§© κµ¬ν„λ λ¨λΈ

- **MF (Matrix Factorization)**
- **LightGCN**
- **CSAR (C0-Support Attention RecSys)**
- **CSAR-R (CSAR with Residual connections)**
- **CSAR-BPR (CSAR with Bayesian Personalized Ranking loss)**

## π’Ύ μ‚¬μ© κ°€λ¥ν• λ°μ΄ν„°μ…‹

- **MovieLens 100K**
- **MovieLens 1M**
- **Amazon Music**
- **Amazon TV & Movie**

## π€ μ‹μ‘ν•κΈ°

### 1. μ„¤μΉ

```bash
# 1. ν”„λ΅μ νΈ ν΄λ΅ 
git clone https://github.com/your-username/recsys_framework.git
cd recsys_framework

# 2. κ°€μƒν™κ²½ μƒμ„± λ° ν™μ„±ν™”
uv venv --python 3.12.0
source .venv/bin/activate

# 3. μμ΅΄μ„± μ„¤μΉ
uv pip install -r requirements.txt
```

### 2. μ‚¬μ©λ²•

#### λ‹¨μΌ μ‹¤ν— μ‹¤ν–‰

νΉμ • λ¨λΈκ³Ό λ°μ΄ν„°μ…‹ μ„¤μ •μΌλ΅ λ‹¨μΌ μ‹¤ν—μ„ μ‹¤ν–‰ν•©λ‹λ‹¤.

```bash
uv run python main.py --dataset_config configs/dataset/ml100k.yaml --model_config configs/model/mf.yaml
```

#### ν•μ΄νΌνλΌλ―Έν„° κ·Έλ¦¬λ“ μ„μΉ

μ„¤μ • νμΌμ— μ •μλ ν•μ΄νΌνλΌλ―Έν„° λ©λ΅μ„ μ΅°ν•©ν•μ—¬ μ—¬λ¬ μ‹¤ν—μ„ μλ™μΌλ΅ μ‹¤ν–‰ν•©λ‹λ‹¤. `configs/model/` λ‚΄μ YAML νμΌμ—μ„ νΉμ • νλΌλ―Έν„° κ°’μ„ λ¦¬μ¤νΈλ΅ μ§€μ •ν•λ©΄ ν•΄λ‹Ή νλΌλ―Έν„°μ— λ€ν• κ·Έλ¦¬λ“ μ„μΉκ°€ μν–‰λ©λ‹λ‹¤.

```yaml
# μμ‹: configs/model/csar.yaml
model:
  name: "CSAR"
  embedding_dim: 64
  num_layers: [2, 3, 4] # num_layersλ¥Ό 2, 3, 4λ΅ λ³€κ²½ν•λ©° μ‹¤ν—
train:
  learning_rate: [0.001, 0.005] # learning_rateλ¥Ό 0.001, 0.005λ΅ λ³€κ²½ν•λ©° μ‹¤ν—
```

μ„μ™€ κ°™μ΄ μ„¤μ • ν›„ μ•„λ λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•©λ‹λ‹¤.

```bash
uv run python grid_search.py --dataset_config configs/dataset/ml100k.yaml --model_config configs/model/csar.yaml
```

#### λ¨λ“  μ‹¤ν— μ‹¤ν–‰ λ° κ²°κ³Ό μ”μ•½

μ§€μ •λ λ°μ΄ν„°μ…‹μ— λ€ν•΄ `run_all_experiments.py`μ— μ •μλ λ¨λ“  λ¨λΈμ κ·Έλ¦¬λ“ μ„μΉλ¥Ό μ‹¤ν–‰ν•κ³ , μµμΆ… κ²°κ³Όλ¥Ό `results_summary.csv` νμΌλ΅ μ·¨ν•©ν•©λ‹λ‹¤.

```bash
# MovieLens 100K λ°μ΄ν„°μ…‹μΌλ΅ λ¨λ“  μ‹¤ν— μ‹¤ν–‰
puv run ython run_all_experiments.py --dataset_config configs/dataset/ml100k.yaml
```

## β™οΈ μ„¤μ • (Configuration)

μ‹¤ν—μ€ `configs` λ””λ ‰ν† λ¦¬μ YAML νμΌμ„ ν†µν•΄ μ μ–΄λ©λ‹λ‹¤.

- `configs/dataset/`: λ°μ΄ν„°μ…‹μ κ²½λ΅, μ΄λ¦„, ν¬λ§· λ“± λ°μ΄ν„° κ΄€λ ¨ μ„¤μ •μ„ μ •μν•©λ‹λ‹¤.
- `configs/model/`: λ¨λΈμ κµ¬μ΅°, ν•μ΄νΌνλΌλ―Έν„°, ν•™μµ κ΄€λ ¨ μ„¤μ •μ„ μ •μν•©λ‹λ‹¤.

## π“ ν”„λ΅μ νΈ κµ¬μ΅°

```
.
β”β”€β”€ configs/              # λ°μ΄ν„°μ…‹ λ° λ¨λΈ μ„¤μ • νμΌ
β”‚   β”β”€β”€ dataset/
β”‚   β””β”€β”€ model/
β”β”€β”€ data/                 # μ›λ³Έ λ°μ΄ν„°μ…‹
β”β”€β”€ src/                  # μ†μ¤ μ½”λ“
β”‚   β”β”€β”€ models/           # μ¶”μ² λ¨λΈ κµ¬ν„μ²΄
β”‚   β”β”€β”€ data_loader.py    # λ°μ΄ν„° λ΅λ”© λ° μ „μ²λ¦¬
β”‚   β”β”€β”€ trainer.py        # λ¨λΈ ν•™μµ λ° ν‰κ°€ λ΅μ§
β”‚   β”β”€β”€ evaluation.py     # ν‰κ°€ μ§€ν‘ κ³„μ‚°
β”‚   β””β”€β”€ utils.py          # μ ν‹Έλ¦¬ν‹° ν•¨μ
β”β”€β”€ trained_model/        # ν•™μµλ λ¨λΈκ³Ό κ²°κ³Όκ°€ μ €μ¥λλ” κ²½λ΅
β”β”€β”€ main.py               # λ‹¨μΌ μ‹¤ν— μ‹¤ν–‰ μ¤ν¬λ¦½νΈ
β”β”€β”€ grid_search.py        # κ·Έλ¦¬λ“ μ„μΉ μ‹¤ν–‰ μ¤ν¬λ¦½νΈ
β””β”€β”€ run_all_experiments.py # λ¨λ“  μ‹¤ν— μ‹¤ν–‰ λ° κ²°κ³Ό μ·¨ν•© μ¤ν¬λ¦½νΈ
```

## π“ κ²°κ³Ό

- κ° μ‹¤ν—μ κ²°κ³Ό(ν•™μµλ λ¨λΈ, λ΅κ·Έ, μµμΆ… ν‰κ°€μ§€ν‘)λ” `trained_model/{λ°μ΄ν„°μ…‹λ…}/{μ‹¤ν–‰λ…}/` λ””λ ‰ν† λ¦¬μ— μ €μ¥λ©λ‹λ‹¤.
- `run_all_experiments.py` μ‹¤ν–‰ μ‹, λ¨λ“  μ‹¤ν—μ μµμΆ… ν‰κ°€μ§€ν‘κ°€ μ·¨ν•©λμ–΄ λ£¨νΈ λ””λ ‰ν† λ¦¬μ `results_summary.csv` νμΌλ΅ μƒμ„±λ©λ‹λ‹¤.